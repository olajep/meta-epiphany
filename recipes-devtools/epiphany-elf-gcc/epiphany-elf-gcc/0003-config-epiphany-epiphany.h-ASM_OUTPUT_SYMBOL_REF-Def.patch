From 1cbc700c7062e5e492852c9c17c115f7d91a32ee Mon Sep 17 00:00:00 2001
From: Joern Rennecke <joern.rennecke@embecosm.com>
Date: Wed, 31 Jul 2013 11:07:32 +0100
Subject: [PATCH 03/33] * config/epiphany/epiphany.h (ASM_OUTPUT_SYMBOL_REF):
 Define.

---
 gcc/ChangeLog.epiphany         | 4 ++++
 gcc/config/epiphany/epiphany.h | 9 +++++++++
 2 files changed, 13 insertions(+)

diff --git a/gcc/ChangeLog.epiphany b/gcc/ChangeLog.epiphany
index 891b777d05b..bc579231d89 100644
--- a/gcc/ChangeLog.epiphany
+++ b/gcc/ChangeLog.epiphany
@@ -1,3 +1,7 @@
+2013-07-31  Joern Rennecke <joern.rennecke@embecosm.com>
+
+	* config/epiphany/epiphany.h (ASM_OUTPUT_SYMBOL_REF): Define.
+
 2013-07-30  Joern Rennecke <joern.rennecke@embecosm.com>
 
 	PR rtl-optimization/58029
diff --git a/gcc/config/epiphany/epiphany.h b/gcc/config/epiphany/epiphany.h
index 676fc63c56f..a1e2155032f 100644
--- a/gcc/config/epiphany/epiphany.h
+++ b/gcc/config/epiphany/epiphany.h
@@ -736,6 +736,15 @@ extern char epiphany_punct_chars[256];
 #define PRINT_OPERAND_PUNCT_VALID_P(CHAR) \
   epiphany_punct_chars[(unsigned char) (CHAR)]
 
+#define ASM_OUTPUT_SYMBOL_REF(FILE, SYM) \
+  do \
+    { \
+      assemble_name ((FILE), (XSTR ((SYM), 0))); \
+      if (flag_pic && ! SYMBOL_REF_LOCAL_P (x)) \
+	fputs ("@PLT", FILE); \
+    } \
+  while (0)
+
 /* This is how to output an element of a case-vector that is absolute.  */
 #define ASM_OUTPUT_ADDR_VEC_ELT(FILE, VALUE)  \
 do { \
-- 
2.31.1

